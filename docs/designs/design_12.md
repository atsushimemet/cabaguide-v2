# 開発ノート: design_12 キャスト詳細ページの料金ガイダンス

issue_12 全体で必要となる「概算であることの明示」と「公式情報への導線」を整理する。後述で追加要件として丸め処理も扱う。

## 1. 背景と目的
- 店舗ごとに料金体系が大きく異なるため、本プロダクトでは詳細な料金ではなく概算提示を優先する。
- キャスト詳細ページで利用者が金額の前提を誤解しないよう、2 時間ベースであること・公式ページで詳細を確認してほしい旨を伝える。
- キャスト所属店舗の詳細ページに遷移させ、正確な料金や最新情報を参照できるようにする。

## 2. UI/UX 仕様
1. 「時間を調整して予算感を掴みましょう。」の文言を以下の一文に置き換える。改行は CSS に任せる。
   - `時間を調整して予算感を掴みましょう。開始時間から連続した2時間分の料金を参照します。料金概算のため詳細は店舗ページをご確認ください。`
2. 追加された「店舗ページ」部分を `next/link` の `Link` で囲い、所属店舗詳細へ遷移させる。`aria-label` を付与しアクセシビリティを担保。
3. 既存の `※` で始まる注釈は削除し、説明テキストは上記 1 行に集約する。

## 3. データ要件
- `BudgetCalculator` に渡す `store: Store` で店舗ページに遷移できる識別子 (`slug` or `id`) を必須にする。
- `Store` 型に `slug` が存在しない場合はフィールドを追加し、キャスト詳細ページの取得クエリにも含める。

## 4. 実装ポイント
1. `storePageHref = store.slug ? \`/stores/${store.slug}\` : undefined` のようにリンク先を決定し、未定義ならリンク自体を非表示。
2. テキスト変更は `BudgetCalculator` のヘッダー部分で行い、3 文目の「店舗ページ」は `Link` コンポーネントに置き換える。
3. ツールチップ (`tooltipDetails`) の説明は既存内容を流用しつつ、1 行目で「開始時間から連続した2時間分」を明示。

## 5. テスト観点
- キャスト詳細ページで新文言が表示され、クリックすると所属店舗ページに遷移する。
- `store.slug` が取得できないストアでも UI が崩れず、リンクだけが非表示になる。

---

# 開発ノート: design_12 料金概算の5000円単位丸め

issue_12 で追加されたキャスト詳細ページの概算料金表示に対し、算出結果 (`ESTIMATE`) を 5,000 円単位で四捨五入して表示する要件を整理する。

## 1. 背景
- 料金計算では細かな料金テーブルを合算するため、端数を含む値が返る。
- 画面上では「概算」としてシンプルな値を提示したいとの要望があり、5,000 円刻みでの丸め表示を実施する。

## 2. 対象
- `src/components/BudgetCalculator.tsx`
  - `calculateBudget` の計算ロジックはそのままに、表示する `result.total` を 5,000 円単位で四捨五入した値に差し替える。
  - 「ESTIMATE」セクションの金額テキストのみを変更する想定。

## 3. 表示仕様
1. 算出された合計金額を `roundedTotal = Math.round(result.total / 5000) * 5000` で丸める。
2. `roundedTotal` を `formatYen` に渡して表示する。
3. `result.total` の生値は内訳 (`BudgetBreakdown`) に利用するためそのまま保持し、表記上だけ丸める。
4. 5,000 円未満の値は四捨五入の結果 0 円になるが、実運用では最小でも `5,000` を表示したい場合は `Math.max(5000, roundedTotal)` を検討する (今回の要件では純粋な四捨五入を採用)。

## 4. テスト観点
- 例: 計算結果 43,200 円 → 45,000 円で表示される。
- 例: 42,400 円 → 40,000 円で表示される。
- 例: 2,400 円 → 0 円表示になることを PM と合意するか、必要なら最小値処理を追記。
- 内訳ラベルやツールチップの内容は従来通り、丸め値は金額表示のみ。
