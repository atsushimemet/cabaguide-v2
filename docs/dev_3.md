# 開発計画: エリア選択フロー & キャスト一覧

## 1. 概要
- 目的: トップページの「エリアから探す」導線から都道府県・繁華街を選択し、選択結果に応じたキャスト一覧ページへ遷移できるフローを構築する。
- 成果物: `/todofuken-choice`, `/downtown-choice`, `/casts/[downtownId]` (想定) のページ、ページネーション付きキャストカード表示、静的モックデータ。
- スコープ外: 実DBからのキャスト取得、店舗/キャスト詳細ページ遷移、リアルタイム検索。

## 2. 要件整理
1. トップページのエリアコンポーネントから都道府県/繁華街のリスト表示を削除し、CTA だけ残す (feature_issue_1 状態へ)。
2. CTA 押下で `/todofuken-choice` に遷移し、`area` テーブルの都道府県一覧を選択可能にする。
3. 都道府県選択で `/downtown-choice?prefecture=XX` またはパスパラメータ付き画面に遷移し、該当都道府県配下の繁華街を選択可能にする。
4. 繁華街選択で `/casts/[downtownId]` などに遷移し、対象繁華街のキャストカードを表示。
5. 各繁華街ごとに静的モック31件を用意し、10件ずつ表示する (1ページ目: 1-10, 2ページ目:11-20, 3ページ目:21-30、4ページ目:31のみ)。
6. キャストカードデザインはトップページと同じコンポーネントを共通化。

## 3. 実装方針
1. ルーティング: `src/app/todofuken-choice/page.tsx`, `src/app/downtown-choice/page.tsx`, `src/app/casts/[downtownId]/page.tsx` を用意。
2. データ: 既存 `src/data/area.csv` から `areas.ts` を利用し、都道府県/繁華街抽出ユーティリティ (`@/lib/areas`) を拡張。
3. キャストモック: `src/data/casts.ts` を新設し、各繁華街 ID をキーに 31 件のモックを生成するスクリプト (再利用可) を整備。
4. ページネーション: URL クエリ `?page=1` を想定し、10件刻みでカードを slice。ページ数計算とナビゲーション UI は共通コンポーネント化。
5. UI: 選択ページはトップページと同じトーン (ネオングラデーション) を維持。アクセシビリティのためキーボード操作可能なボタン/リンクとする。

## 4. タスク分解
1. **トップページ変更**: エリアコンポーネントから一覧 UI を取り除き CTA のみ残す。
2. **データユーティリティ整備**:
   - 都道府県一覧取得ヘルパー
   - 都道府県 -> 繁華街フィルタ関数
   - 繁華街 ID 生成ルール (slug) を決定
3. **キャストモック作成**: 31 件データのスキーマ確定、生成スクリプト or 手動整備。
4. **都道府県選択ページ**: レイアウト/選択カード実装、クリックで次画面遷移。
5. **繁華街選択ページ**: 選択された都道府県を表示し、該当繁華街リストを描画、遷移ロジック実装。
6. **キャスト一覧ページ**: キャストカードグリッド、ページネーション、URL 同期。
7. **共通コンポーネント**: ボタン、カード、ページネーションを再利用可能に整理。
8. **テスト/確認**: ルーティング/遷移の動作確認、ページネーションの境界テスト、Lint/Type Check。

## 5. スケジュール目安
- Day 1: 仕様整理、トップページ回帰、データユーティリティ整理。
- Day 2: 都道府県/繁華街選択ページの UI 実装。
- Day 3: キャストモックデータ生成 & 一覧ページ組み立て。
- Day 4: ページネーション・動線/アクセシビリティ調整、共通化。
- Day 5: リグレッションテスト、ドキュメント更新、レビュー。

## 6. リスクと対策
- **ルーティング構成の複雑化**: App Router の構造を早めに決め、URL 設計をチームでレビュー。
- **モックデータの整合性**: 生成スクリプトで deterministic な ID/スコア/画像 URL を作り、後続の差し替えを容易にする。
- **ページネーションの UX**: 10件区切り + 最終ページ件数をわかりやすく表示し、無効ページ遷移時は1ページ目にフォールバック。
- **トップページとのスタイル差異**: 共通スタイルトークンを `globals.css` や専用モジュールにまとめてブレを減らす。

## 7. 成果物チェックリスト
- [ ] トップページの CTA 内から都道府県/繁華街リストを削除。
- [ ] `/todofuken-choice` で都道府県を選択できる。
- [ ] `/downtown-choice` で選択した都道府県に属する繁華街を選択できる。
- [ ] `/casts/[downtownId]` で 31 件モックをページネーション付きで表示。
- [ ] キャストカードはトップページと共通スタイル。
- [ ] ルーティング/遷移/ページネーションのテスト & Lint/Type Check 通過。
